<svg xmlns="http://www.w3.org/2000/svg" width="580" height="360" viewBox="0 0 580 360">
  <defs>
    <!-- Gradient for inflation layer -->
    <radialGradient id="inflGrad1" cx="50%" cy="50%" r="50%">
      <stop offset="0%"   stop-color="#e74c3c" stop-opacity="0.85"/>
      <stop offset="40%"  stop-color="#f39c12" stop-opacity="0.6"/>
      <stop offset="80%"  stop-color="#f1c40f" stop-opacity="0.3"/>
      <stop offset="100%" stop-color="#f1c40f" stop-opacity="0"/>
    </radialGradient>
    <radialGradient id="inflGrad2" cx="50%" cy="50%" r="50%">
      <stop offset="0%"   stop-color="#e74c3c" stop-opacity="0.85"/>
      <stop offset="40%"  stop-color="#f39c12" stop-opacity="0.6"/>
      <stop offset="80%"  stop-color="#f1c40f" stop-opacity="0.3"/>
      <stop offset="100%" stop-color="#f1c40f" stop-opacity="0"/>
    </radialGradient>
    <!-- Skew transform for 3D perspective -->
  </defs>

  <!-- Background -->
  <rect width="580" height="360" fill="#f9f9fb" rx="8" stroke="#dde" stroke-width="1"/>

  <!-- Title -->
  <text x="290" y="26" text-anchor="middle"
        font-family="'Microsoft YaHei', 'PingFang SC', Arial, sans-serif"
        font-size="14" font-weight="bold" fill="#222">代价地图分层示意（costmap_2d）</text>

  <!-- === Layer 1: Static Layer (bottom) === -->
  <!-- Parallelogram for 3D effect: offset 40px up-right per layer -->
  <g transform="translate(40, 210)">
    <!-- Layer background -->
    <path d="M 0,80 L 240,80 L 280,40 L 40,40 Z"
          fill="#ecf0f1" stroke="#bdc3c7" stroke-width="1.5"/>
    <!-- Grid lines on layer -->
    <line x1="80"  y1="40" x2="40"  y2="80" stroke="#bbb" stroke-width="0.7"/>
    <line x1="120" y1="40" x2="80"  y2="80" stroke="#bbb" stroke-width="0.7"/>
    <line x1="160" y1="40" x2="120" y2="80" stroke="#bbb" stroke-width="0.7"/>
    <line x1="200" y1="40" x2="160" y2="80" stroke="#bbb" stroke-width="0.7"/>
    <line x1="240" y1="40" x2="200" y2="80" stroke="#bbb" stroke-width="0.7"/>
    <!-- Horizontal grid lines -->
    <line x1="40"  y1="53" x2="268" y2="53" stroke="#bbb" stroke-width="0.7"/>
    <line x1="40"  y1="67" x2="256" y2="67" stroke="#bbb" stroke-width="0.7"/>
    <!-- Wall obstacles (black cells) -->
    <rect x="65"  y="44" width="14" height="12" fill="#7f8c8d" rx="1"/>
    <rect x="80"  y="44" width="14" height="12" fill="#7f8c8d" rx="1"/>
    <rect x="95"  y="44" width="14" height="12" fill="#7f8c8d" rx="1"/>
    <rect x="80"  y="57" width="14" height="11" fill="#7f8c8d" rx="1"/>
    <!-- Layer label -->
    <text x="-10" y="65"
          font-family="'Microsoft YaHei', Arial, sans-serif"
          font-size="11" font-weight="bold" fill="#2c3e50">静态层</text>
    <text x="-10" y="79"
          font-family="'Microsoft YaHei', Arial, sans-serif"
          font-size="9" fill="#666">（SLAM 地图）</text>
  </g>

  <!-- === Layer 2: Obstacle Layer (middle) === -->
  <g transform="translate(40, 150)">
    <path d="M 0,80 L 240,80 L 280,40 L 40,40 Z"
          fill="rgba(255,255,255,0.88)" stroke="#95a5a6" stroke-width="1.5"/>
    <!-- Grid lines -->
    <line x1="80"  y1="40" x2="40"  y2="80" stroke="#ddd" stroke-width="0.6"/>
    <line x1="120" y1="40" x2="80"  y2="80" stroke="#ddd" stroke-width="0.6"/>
    <line x1="160" y1="40" x2="120" y2="80" stroke="#ddd" stroke-width="0.6"/>
    <line x1="200" y1="40" x2="160" y2="80" stroke="#ddd" stroke-width="0.6"/>
    <line x1="240" y1="40" x2="200" y2="80" stroke="#ddd" stroke-width="0.6"/>
    <line x1="40"  y1="53" x2="268" y2="53" stroke="#ddd" stroke-width="0.6"/>
    <line x1="40"  y1="67" x2="256" y2="67" stroke="#ddd" stroke-width="0.6"/>
    <!-- Dynamic obstacles (red dots with sensor scan lines) -->
    <circle cx="155" cy="58" r="7" fill="#e74c3c"/>
    <circle cx="195" cy="66" r="6" fill="#e74c3c"/>
    <!-- Laser scan indicator -->
    <line x1="280" y1="40" x2="155" y2="58" stroke="#e74c3c" stroke-width="0.8" stroke-dasharray="3,2" opacity="0.5"/>
    <line x1="280" y1="40" x2="195" y2="66" stroke="#e74c3c" stroke-width="0.8" stroke-dasharray="3,2" opacity="0.5"/>
    <!-- Layer label -->
    <text x="-10" y="65"
          font-family="'Microsoft YaHei', Arial, sans-serif"
          font-size="11" font-weight="bold" fill="#2c3e50">障碍物层</text>
    <text x="-10" y="79"
          font-family="'Microsoft YaHei', Arial, sans-serif"
          font-size="9" fill="#666">（实时传感器）</text>
  </g>

  <!-- === Layer 3: Inflation Layer (top) === -->
  <g transform="translate(40, 90)">
    <path d="M 0,80 L 240,80 L 280,40 L 40,40 Z"
          fill="rgba(255,255,255,0.92)" stroke="#7f8c8d" stroke-width="1.5"/>
    <!-- Inflation gradient circles around obstacles -->
    <!-- Static wall inflation (aligned with layer 1 walls ~x=70-115, y=50) -->
    <ellipse cx="100" cy="55" rx="40" ry="22" fill="url(#inflGrad1)" opacity="0.8"/>
    <!-- Dynamic obstacle inflations -->
    <circle cx="155" cy="60" r="28" fill="url(#inflGrad2)" opacity="0.85"/>
    <circle cx="195" cy="65" r="24" fill="url(#inflGrad2)" opacity="0.80"/>
    <!-- Obstacle centers (carry through) -->
    <circle cx="155" cy="60" r="6" fill="#e74c3c"/>
    <circle cx="195" cy="65" r="5" fill="#e74c3c"/>
    <!-- inflation_radius annotation -->
    <line x1="155" y1="60" x2="183" y2="47"
          stroke="#e67e22" stroke-width="1.2" stroke-dasharray="3,2"/>
    <text x="187" y="43"
          font-family="'Microsoft YaHei', Arial, sans-serif"
          font-size="9" fill="#e67e22">inflation_radius</text>
    <!-- Layer label -->
    <text x="-10" y="65"
          font-family="'Microsoft YaHei', Arial, sans-serif"
          font-size="11" font-weight="bold" fill="#2c3e50">膨胀层</text>
    <text x="-10" y="79"
          font-family="'Microsoft YaHei', Arial, sans-serif"
          font-size="9" fill="#666">（代价梯度）</text>
  </g>

  <!-- === Layer arrows / stacking indicator === -->
  <text x="365" y="135" font-family="'Microsoft YaHei', Arial, sans-serif"
        font-size="11" fill="#555">↑ 膨胀层（代价梯度）</text>
  <text x="365" y="195" font-family="'Microsoft YaHei', Arial, sans-serif"
        font-size="11" fill="#555">↑ 障碍物层（动态实时）</text>
  <text x="365" y="255" font-family="'Microsoft YaHei', Arial, sans-serif"
        font-size="11" fill="#555">↑ 静态层（全局地图）</text>

  <!-- === Combined costmap output arrow === -->
  <text x="290" y="315" text-anchor="middle"
        font-family="'Microsoft YaHei', Arial, sans-serif"
        font-size="11" font-weight="bold" fill="#2c3e50">三层叠加 → 最终代价地图（路径规划器使用）</text>

  <!-- === Legend for inflation colors === -->
  <g transform="translate(90, 335)">
    <rect x="0" y="-10" width="16" height="16" fill="#e74c3c" rx="2"/>
    <text x="20" y="4" font-family="'Microsoft YaHei', Arial, sans-serif"
          font-size="10" fill="#333">致命代价（障碍物）</text>
    <rect x="155" y="-10" width="16" height="16" fill="#f39c12" rx="2"/>
    <text x="175" y="4" font-family="'Microsoft YaHei', Arial, sans-serif"
          font-size="10" fill="#333">高代价（近障碍）</text>
    <rect x="305" y="-10" width="16" height="16" fill="#f1c40f" rx="2"/>
    <text x="325" y="4" font-family="'Microsoft YaHei', Arial, sans-serif"
          font-size="10" fill="#333">低代价（远障碍）</text>
  </g>
</svg>
